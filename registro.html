<script>
  const form = document.getElementById("registroForm");
  const mensaje = document.getElementById("mensaje");

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    const nombre = document.getElementById("nombre").value.trim();
    const email = document.getElementById("email").value.trim();
    const telefono = document.getElementById("telefono").value.trim();
    const curso = document.getElementById("curso").value.trim();

    // Agrega esta línea para ver los datos antes del fetch()
    console.log("Datos recogidos:", { nombre, email, telefono, curso });

    // Enviar a Google Sheets
    fetch('https://script.google.com/macros/s/AKfycbwn-VYN9nFJpYeMgXhuW9PFB04xphwuEjr1nbVG4lx7f_9mCqfaGWMtDIuJtfDROZo/exec',  {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        nombre,
        email,
        telefono,
        curso
      })
    })
    .then(res => {
      console.log("Respuesta del servidor:", res);
      return res.json();
    })
    .then(data => {
      console.log("Datos enviados:", data);

      // Guardar en Firebase
      db.collection("usuarios").add({
        nombre,
        email,
        telefono,
        curso,
        fecha: new Date()
      }).then(() => {
        mensaje.style.color = "green";
        mensaje.textContent = "✅ Registro exitoso. ¡Gracias!";
        form.reset();
        btnEnviar.disabled = false;
        btnEnviar.textContent = "Enviar Registro";
      }).catch((error) => {
        console.error("Error al guardar en Firebase:", error);
        mensaje.style.color = "red";
        mensaje.textContent = "⚠️ Hubo un error al guardar en Firebase.";
        btnEnviar.disabled = false;
        btnEnviar.textContent = "Enviar Registro";
      });

    })
    .catch(err => {
      console.error("❌ Error al enviar:", err);
      mensaje.style.color = "red";
      mensaje.textContent = "Hubo un error al enviar los datos.";
      btnEnviar.disabled = false;
      btnEnviar.textContent = "Enviar Registro";
    });
  });
</script>
